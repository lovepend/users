const insertRows = function (rowCount) {
  const grid = gridRef.value
  grid.stopEditing()
  grid.setGridOption('loading', true)

  // 1. 필터 모델 가져오기 및 콘솔 출력
  const filterModel = grid.getFilterModel()
  
  console.log('======= [AG-GRID FILTER DEBUG] =======')
  if (Object.keys(filterModel).length === 0) {
    console.log('현재 적용된 필터가 없습니다.')
  } else {
    console.table(filterModel) // 테이블 형태로 깔끔하게 출력
    console.log('전체 구조:', filterModel)
  }
  console.log('======================================')

  const filterDefaults = {}

  // 2. 값 추출 (추출 로직 보강)
  Object.keys(filterModel).forEach((colId) => {
    const model = filterModel[colId]
    
    // Set Filter (체크박스)일 때
    if (model.filterType === 'set') {
      filterDefaults[colId] = model.values[0]
    } 
    // 일반 필터 (Text, Number 등)
    else {
      // 단일 조건일 때
      if (model.filter !== undefined) {
        filterDefaults[colId] = model.filter
      } 
      // AND/OR 복합 조건일 때
      else if (model.condition1) {
        filterDefaults[colId] = model.condition1.filter
      }
    }
  })

  const addRows = []
  for (let i = 0; i < rowCount; i++) {
    const newId = `new_${Math.random().toString(36).substring(2, 12)}`
    
    // 3. 필터 값을 기본값으로 세팅
    const newRow = {
      STATUS: 'A',
      PROJ_NO: currentProjNo.value,
      ATT_ID: null,
      CL_ID: null,
      VAL_TYPE: VAL_TYPES.STRING.VALUE,
      RDON_YN: false,
      IGN_LIST_VAL: false,
      CRTER_NO: userInfo.value?.UserID,
      _id: newId,
      ...filterDefaults  // 추출된 필터 값들을 새 행에 병합
    }
    
    addRows.push(newRow)
  }

  // 이후 로직 동일...
  if (addRows.length > 0) {
    const lastIndex = grid.getDisplayedRowCount()
    const result = grid.applyTransaction({ add: addRows, addIndex: lastIndex })
    
    grid.refreshCells({ force: true, suppressFlash: true })
    grid.setNodesSelected({ nodes: result.add, newValue: true })
    grid.ensureIndexVisible(lastIndex, 'bottom')
  }
  grid.setGridOption('loading', false)
}
