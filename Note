  // 어댑터 맵핑 목록 Grid -> defaultColDef
  const defaultColDef_MapAdapter = ref({
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  })

  // 어트리뷰트 맵핑 목록 Grid -> defaultColDef
  const defaultColDef_MapAttr = ref({
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  })

  // Class 매핑 Gird -> defaultColDef
  const defaultColDef_MapClass = ref({
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  })

  // Template 매핑 Gird -> defaultColDef
  const defaultColDef_MapTmpl = ref({
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  })

  // Relation 매핑 Grid -> defaultColDef
  const defaultColDef_MapRel = ref({
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: true,
    sortable: false,
  })

  // EP 데이터 목록 Grid -> defaultColDef
  const defaultColDef_EPAttr = {
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  }

  // 툴(Source) 어댑터 데이터 목록 Grid -> defaultColDef
  const defaultColDef_ToolAttr = {
    filter: 'agMultiColumnFilter',
    floatingFilter: true,
    filterParams: agMultiColumnFilterParams,
    editable: false,
    sortable: false,
  }

  const loadingOverlayComponentParams = {
    loadingMessage: 'Loading...',
  }
  const statusBar = {
    statusPanels: [
      { statusPanel: 'agTotalRowCountComponent' },
      { statusPanel: 'agFilteredRowCountComponent' },
      { statusPanel: 'agSelectedRowCountComponent' },
    ],
  }

  // 어댑터 맵핑 목록 Grid -> columnDefs
  const colDefs_MapAdapter = ref([
    { checkboxSelection: true, filter: false, suppressHeaderMenuButton: true, maxWidth: 35 },
    {
      field: 'MAP_ID',
      headerName: 'Adapter Map ID',
      flex: 1,
      minWidth: 120,
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'EP_ID',
      headerName: 'EP',
      flex: 0.5,
      minWidth: 50,
      cellEditor: 'agRichSelectCellEditor',
      cellEditorParams: function (params) {
        const epIds = projectPermissions.value
          .filter(el => isProjectAdmin.value || el.Role === 'Manager')
          .map(el => el.EP_ID)
        return {
          values: epIds,
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 220,
        }
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'REG_TYPE_ID',
      headerName: 'Register ID',
      flex: 1,
      minWidth: 100,
      cellEditor: 'agRichSelectCellEditor',
      cellEditorParams: function (params) {
        const regTypeIds = allRegisterList.value
          .filter(item => item.EP_ID === params.data.EP_ID)
          .map(item => item.REG_TYPE_ID)

        return {
          values: regTypeIds,
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 120,
        }
      },
      valueFormatter: params => {
        const targetObject = allRegisterList.value.find(item => item.REG_TYPE_ID === params.value)

        return targetObject ? `(${targetObject.REG_TYPE_ID}) ${targetObject.REG_DESC}` : ''
      },
      cellRenderer: params => {
        return (
          `<a href="` +
          import.meta.env.BASE_URL +
          `register-mapping-setup?reg_type_id=${params.value}&proj_no=${route.query.proj_no}&ep_id=${route.query.ep_id}" target="_blank">` +
          params.value +
          `</a>`
        )
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'REG_DESC',
      headerName: 'Register Desc.',
      editable: false,
      flex: 1.5,
      minWidth: 120,
      valueGetter: function (params) {
        const item = allRegisterList.value.find(i => i.REG_TYPE_ID === params.data.REG_TYPE_ID)

        return item ? item.REG_DESC : ''
      },
    },
    {
      field: 'DESC',
      headerName: 'Adapter Name',
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
      flex: 1.5,
      minWidth: 120,
    },
    {
      field: 'CMPLX_YN',
      headerName: 'Complex',
      editable: false,
      maxWidth: 75,
      valueGetter: function (params) {
        const item = allRegisterList.value.find(i => i.REG_TYPE_ID === params.data.REG_TYPE_ID)

        params.data.CMPLX_YN = item?.CMPLX_YN

        return item?.CMPLX_YN ? 'Y' : 'N'
      },
    },

    {
      field: 'SCOPES',
      headerName: 'Scopes',
      flex: 1,
      minWidth: 100,
      cellEditor: 'AgMultiSelectEditor',
      cellEditorParams: function (params) {
        let scopeOptions = []
        if (ToolAttrListRef.value && ToolAttrListRef.value.length > 0) {
          const uniqueScopes = new Set(
            ToolAttrListRef.value
              .map(item => item.SCOPE)
              .filter(scope => scope !== undefined && scope !== null && scope !== '')
          )
          scopeOptions = Array.from(uniqueScopes)
        }

        return {
          listData: scopeOptions,
          isMultiple: true,
          isPushNew: true,
          placeholder: 'Select or type Scopes',
        }
      },
      singleClickEdit: true,
      cellEditorPopup: true,
      cellEditorPopupPosition: 'over',
      valueFormatter: params => {
        if (Array.isArray(params.value)) {
          return params.value.join(', ')
        }
        return params.value || ''
      },
      cellRenderer: function (param) {
        const displayValue = Array.isArray(param.value) ? param.value.join(', ') : param.value
        return makeComboRender({ ...param, value: displayValue }, 'dropbox')
      },
      // filter: 'agMultiColumnFilter'는 defaultColDef에서 이미 적용. 여기서 명시X
      filterParams: {
        // filterParams만 재정의
        filters: [
          {
            filter: 'agTextColumnFilter',
            display: 'inline', // 'accordion', 'inline', 'subMenu' 등
            filterParams: {
              buttons: ['reset'],
            },
          },
          {
            filter: 'agSetColumnFilter',
            display: 'inline',
            filterParams: {
              array: true,
              valueFormatter: params => {
                return params.value
              },
              buttons: ['reset'],
            },
          },
        ],
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'CATEGORY',
      headerName: 'Map Type',
      flex: 0.5,
      minWidth: 80,
      cellEditor: 'agRichSelectCellEditor',
      cellEditorParams: function (params) {
        return {
          values: ['TOOL', 'BROKER', 'CUSTOM'],
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 220,
        }
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'TOOL_ID',
      headerName: 'Tool(Source) ID',
      flex: 1.5,
      minWidth: 50,
      cellEditor: 'agRichSelectCellEditor',
      cellEditorParams: function (params) {
        let toolIds = []

        if (params.data.CATEGORY === 'TOOL') {
          toolIds = allToolList.value.map(item => item.TOOL_ID)
        } else if (params.data.CATEGORY === 'BROKER') {
          toolIds = [...new Set(allBrokerList.value.map(item => item.GROUP))]
        } else if (params.data.CATEGORY === 'CUSTOM') {
          toolIds = allCustomList.value.map(item => item.CUS_ID)
        }

        return {
          values: toolIds,
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 220,
        }
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'TOOL_TYPE',
      headerName: 'Item Type',
      flex: 1.5,
      minWidth: 50,
      cellEditor: 'AgMultiSelectEditor',
      cellEditorParams: function (params) {
        let toolTypes = []

        if (params.data.CATEGORY === 'TOOL') {
          const toolItem = allToolList.value.find(item => item.TOOL_ID === params.data.TOOL_ID)
          toolTypes = toolItem ? toolItem.TOOL_TYPES.map(item => item) : []
        } else if (params.data.CATEGORY === 'BROKER') {
          toolTypes = allBrokerList.value.filter(item => item.GROUP === params.data.TOOL_ID).map(item => item.NAME)
        } else if (params.data.CATEGORY === 'CUSTOM') {
          const customItem = allCustomList.value.find(item => item.CUS_ID === params.data.TOOL_ID)
          toolTypes = customItem ? customItem.SOURCES.map(item => item.SRC_NM) : []
        }

        return {
          values: toolTypes,
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 220,
          listData: toolTypes,
          isMultiple: false,
          isPushNew: true,
          isCloseBox: true,
          placeholder: 'Select Tool Type',
        }
      },
      singleClickEdit: true,
      cellEditorPopup: true,
      cellEditorPopupPosition: 'over',
      cellRenderer: function (param) {
        return makeComboRender(param, 'dropbox')
      },
      editable: params => {
        return projectPermissions.value.some(
          el =>
            isProjectAdmin.value ||
            ((params.data.EP_ID === '' || el.EP_ID === params.data.EP_ID) && el.Role === 'Manager')
        )
      },
    },
    {
      field: 'Broker_Action',
      headerName: 'Broker_Action',
      minWidth: 100,
      initialWidth: 200,
      flex: 1,
      editable: false,
      cellEditorParams: function (params) {
        let toolTypes = []

        if (params.data.CATEGORY === 'BROKER') {
          const toolItem = allToolList.value.find(item => item.TOOL_ID === params.data.TOOL_ID)
          toolTypes = allBrokerList.value.filter(item => item.GROUP === params.data.TOOL_ID).map(item => item.NAME)
        }

        return {
          values: toolIds,
          valueListGap: 5,
          allowTyping: true,
          filterList: true,
          highlightMatch: true,
          valueListMaxHeight: 220,
        }
      },
    },
    { field: '_id', hide: true },
  ])
