  const onCreateRows = function () {
    if (!currentProjNo.value) {
      sAlert.Warning(`Project를  선택해주세요`)
      return
    }

    insertRows(1)
  }

  const onCreateMultiRows = function (rowCount) {
    if (!currentProjNo.value) {
      sAlert.Warning(`Project를  선택해주세요`)
      return
    }

    insertRows(rowCount)
  }

  const insertRows = function (rowCount) {
    const grid = gridRef.value
    grid.stopEditing()
    grid.setGridOption('loading', true)

    const addRows = []
    for (let i = 0; i < rowCount; i++) {
      const newId = `new_${Math.random().toString(36).substring(2, 12)}`
      addRows.push({
        STATUS: 'A',
        PROJ_NO: currentProjNo.value,
        ATT_ID: null,
        CL_ID: null,
        VAL_TYPE: VAL_TYPES.STRING.VALUE,
        RDON_YN: false,
        IGN_LIST_VAL: false,
        CRTER_NO: userInfo.value?.UserID,
        _id: newId,
      })
    }
    if (addRows.length > 0) {
      const lastIndex = grid.getDisplayedRowCount()
      const result = grid.applyTransaction({ add: addRows, addIndex: lastIndex })
      grid.refreshCells({ force: true, suppressFlash: true })
      grid.setNodesSelected({
        nodes: result.add,
        newValue: true,
      })
      grid.ensureIndexVisible(lastIndex, 'bottom')
    }
    grid.setGridOption('loading', false)
  }
