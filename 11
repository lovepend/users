{
  field: 'UOM_ID',
  headerName: 'UOM',
  minWidth: 80,
  flex: 1,
  headerTooltip: 'Please select UOMGroup first.',
  cellClass: params => {
    const dataItem = params.data
    const valType = dataItem?.VAL_TYPE
    return valType === VAL_TYPES.NUMBER.VALUE ? '' : 'agReadOnly'
  },
  editable: params => {
    const dataItem = params.data
    if (dataItem && dataItem.PROJ_NO === currentProjNo.value) {
      const valType = dataItem.VAL_TYPE
      return valType === VAL_TYPES.NUMBER.VALUE
    }
    return false
  },
  cellRenderer: params => {
    const dataItem = params.data
    const uomGroup = dataItem?.UOM_GROUP
    const valType = dataItem?.VAL_TYPE
    // valueFormatter를 거친 SYMBOL 값이 params.valueFormatted에 담깁니다.
    const displayValue = params.valueFormatted || params.value || ''
    
    if (!dataItem || dataItem.PROJ_NO !== currentProjNo.value) {
      return displayValue
    }
    if (uomGroup || valType === VAL_TYPES.NUMBER.VALUE) {
      return makeComboRender(displayValue)
    }
    return displayValue
  },
  singleClickEdit: true,
  cellEditorPopup: true,
  cellEditorPopupPosition: 'over',
  cellEditor: 'agDropBoxEditor',
  
  // [조회] ID를 SYMBOL로 변환해서 보여줌
  valueFormatter: function (params) {
    if (!params.value) return ''
    const found = uomListRef.value?.find(item => item.UOM_ID === params.value)
    return found ? found.SYMBOL : params.value
  },

  // [저장/입력] 선택된 SYMBOL을 기반으로 ID를 찾아 데이터에 저장 (핵심 수정부)
  valueSetter: function (params) {
    const selectedSymbol = params.newValue
    if (!selectedSymbol) {
      params.data.UOM_ID = null
      return true
    }
    // 선택한 SYMBOL과 일치하는 객체를 찾아 ID를 할당
    const found = uomListRef.value?.find(item => item.SYMBOL === selectedSymbol)
    if (found) {
      params.data.UOM_ID = found.UOM_ID
      return true
    }
    return false
  },

  cellEditorParams: function (params) {
    const dataItem = params.data
    const uomGroup = dataItem?.UOM_GROUP
    let valueList = []

    // 사용자에게 보여줄 리스트는 SYMBOL로 구성
    if (dataItem && uomGroup) {
      valueList = uomListRef.value
        ?.filter(({ GROUP }) => GROUP === uomGroup)
        .map(({ SYMBOL }) => SYMBOL) ?? []
    }

    return {
      listData: valueList,
      placeholder: 'Select Code',
      popupDropBoxHeight: 130,
    }
  },
  tooltipValueGetter: params => params.valueFormatted,
}
