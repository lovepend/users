{
  field: 'UOM_ID',
  headerName: 'UOM',
  minWidth: 80,
  flex: 1,
  headerTooltip: 'Please select UOMGroup first.',
  cellClass: params => {
    const dataItem = params.data
    const valType = dataItem?.VAL_TYPE
    return valType === VAL_TYPES.NUMBER.VALUE ? '' : 'agReadOnly'
  },
  editable: params => {
    const dataItem = params.data
    if (dataItem && dataItem.PROJ_NO === currentProjNo.value) {
      const valType = dataItem.VAL_TYPE
      return valType === VAL_TYPES.NUMBER.VALUE
    }
    return false
  },
  cellRenderer: params => {
    const dataItem = params.data
    const uomGroup = dataItem?.UOM_GROUP
    const valType = dataItem?.VAL_TYPE
    // valueFormatter가 적용된 SYMBOL 값을 우선 표시
    const displayValue = params.valueFormatted || params.value || ''
    
    if (!dataItem || dataItem.PROJ_NO !== currentProjNo.value) {
      return displayValue
    }
    if (uomGroup || valType === VAL_TYPES.NUMBER.VALUE) {
      return makeComboRender(displayValue)
    }
    return displayValue
  },
  singleClickEdit: true,
  cellEditorPopup: true,
  cellEditorPopupPosition: 'over',
  cellEditor: 'agDropBoxEditor',
  
  // 1. 화면에 보여줄 때: ID를 SYMBOL로 변환
  valueFormatter: function (params) {
    const value = params.value
    if (!value) return ''
    const found = uomListRef.value?.find(item => item.UOM_ID === value || item.SYMBOL === value)
    return found ? found.SYMBOL : value
  },

  // 2. 저장할 때: 선택된 SYMBOL을 다시 ID로 변환하여 field('UOM_ID')에 저장
  valueParser: function (params) {
    const newValue = params.newValue
    const found = uomListRef.value?.find(item => item.SYMBOL === newValue)
    return found ? found.UOM_ID : newValue
  },

  cellEditorParams: function (params) {
    const dataItem = params.data
    const uomGroup = dataItem?.UOM_GROUP
    let valueList = []

    // 3. 사용자에게는 SYMBOL 리스트를 보여줌
    if (dataItem && uomGroup) {
      valueList = uomListRef.value
        ?.filter(({ GROUP }) => GROUP === uomGroup)
        .map(({ SYMBOL }) => SYMBOL) ?? []
    }

    return {
      listData: valueList,
      placeholder: 'Select Code',
      popupDropBoxHeight: 130,
    }
  },
  tooltipValueGetter: params => params.valueFormatted,
}
